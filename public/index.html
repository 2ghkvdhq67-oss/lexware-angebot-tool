<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>lexoffice Tool</title>
<style>
body{font-family:system-ui;margin:24px;max-width:800px}
.box{border:1px solid #ddd;border-radius:10px;padding:16px;margin-bottom:16px}
button{padding:10px 14px;border-radius:8px;border:1px solid #999}
.primary{background:#000;color:#fff}
pre{background:#f6f6f6;padding:12px;border-radius:8px}
</style>
</head>
<body>

<h2>lexoffice Angebots-Tool</h2>

<div class="box">
  <button onclick="location.href='/download-template-with-articles'">
    Vorlage herunterladen
  </button>
  <button onclick="apiTest()">API testen</button>
</div>

<div class="box">
  <input id="file" type="file" accept=".xlsx"><br><br>
  <label><input id="testmode" type="checkbox" checked> Testmodus</label><br><br>
  <button class="primary" onclick="run()">Ausführen</button>
  <pre id="out">bereit</pre>
</div>

<script>
async function apiTest(){
  const r=await fetch('/api-test'); 
  out.textContent=JSON.stringify(await r.json(),null,2);
}
async function run(){
  const f=file.files[0]; if(!f)return alert("Excel wählen");
  const url=testmode.checked?'/validate-excel':'/create-quote-from-excel';
  const fd=new FormData(); fd.append('file',f);
  out.textContent="läuft…";
  const r=await fetch(url,{method:'POST',body:fd});
  out.textContent=r.ok
    ? JSON.stringify(await r.json(),null,2)
    : "Fehler";
}
</script>

</body>
</html>
